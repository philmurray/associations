<div class='page-game'>

	<a ng-if="!playing" class="navbar-brand" href="#/">Associations</a>

	<div ng-if="playing" class="word-entry panel panel-default">
		<div class="panel-heading">
			<h4>
				<span>Time Left: {{timeLeft}}</span>
				<span class="pull-right"><a ng-click="skipWord()">Skip...</a></span>
			</h4>
		</div>
		<div class="panel-body">
			<h2 class="text-center">{{playing.word}}</h2>
		</div>
		<div class="panel-footer">
			<select-word selected="chosenWord" class='select-word' focus-input="playing.word"></select-word>
		</div>
	</div>

	<div class="players" ng-if="!playing" ng-class="{expanded:playersExpanded}">
		<!-- TODO: split this out into templates or something... -->
		<button
			ng-repeat="p in game.players | orderBy:'score':true"
			ng-disabled="!p.completed"
			ng-click="activatePlayer(p)"
			class="player btn {{(p.completed && p.color.css_class) || 'btn-default'}}"
			ng-class="{active: p.active, 'btn-xs':!playersExpanded, 'btn-sm':playersExpanded, winner:p.winner}">
			<div>
				<h5>
					<i ng-if="p.winner" class="fa fa-star"></i>
					<span ng-if="playersExpanded">{{p.alias}}</span>
					<span ng-if="!playersExpanded"><strong>{{p.alias | limitTo:1 | uppercase}}</strong></span>
				</h5>
				<p ng-if="p.completed">
					<span class="pull-left">score: </span>
					<span class="pull-right">{{p.score}}</span>
					<br/>
					<span class="pull-left">weirdo: </span>
					<span class="pull-right">{{getNormal(p)}}</span>
				</p>
				<p ng-if="!p.completed">
					Waiting...
					<br/>
					<br/>
				</p>
			</div>
		</button>
	</div>

	<div class="context-controls well" ng-if="!playing && selected">
		<h5>
			<strong>
				{{selected.label}}
				<a href="" ng-if="selected.from" ng-click="selected.expanded = !selected.expanded">
					<i ng-class="{'fa-expand':!selected.expanded, 'fa-compress':selected.expanded}" class="fa"></i></a>
				<a href="#/exploreWords?word={{selected.label}}=&otherWord="><i class="fa fa-search"></i></a>
			</strong>
		</h5>
	</div>

	<div class="chat" ng-if="!playing" ng-class="{well:chat.expanded}">
		<button ng-if="!chat.expanded" class="btn btn-color" ng-click="chat.expanded = true">
			<i class="fa fa-comment"></i>
		</button>
		<div ng-if="chat.expanded">
			<div class="row">
				<div class="col-xs-12">
					<button class="btn btn-color btn-xs pull-right" ng-click="chat.expanded = false">
						<i class="fa fa-minus"></i>
					</button>
				</div>
			</div>
			<div class="messages" scroll-bottom>
				<div ng-repeat="message in chat.messages" class="{{message.player.color.css_class}} row">
					<div class="col-xs-12">
						<p>
							<span class="player">
								<strong class="text-color">{{message.player.alias}}: </strong>
							</span>
							<span class="text-muted">
								{{message.message}}
							</span>
						</p>
					</div>
				</div>
			</div>
			<form class="form-horizontal" name="forms.display">
				<div class="form-group">
					<div class="col-xs-9">
						<input focus-input="chat.expanded" class="form-control" id="chatText" name="chatText" placeholder="what do you want to say?" ng-model="chat.currentText">
					</div>
					<div class="col-xs-3">
						<button class="btn btn-color pull-right" ng-click="submitChat()">
							<i class="fa fa-check-circle"></i>
						</button>
					</div>
				</div>
			</form>
		</div>
	</div>

	<div game-graph
		graph-model="game"
		graph-config="graphConfig"
		graph-playing="playing"
		graph-selected="selected"
		style="width: 100%; height: 100%;"></div>
</div>
